<!DOCTYPE html>
<html>
<head>
    <title>Chatbot</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <style>
    {#back css#}

    body {
    margin: 0;
    font-family: Arial, sans-serif;header {
    position: relative;
    text-align: center;
    color: white;
}

nav {
    height: 90px;
    background-color: rgba(0, 0, 0, 0.3);
    padding: 10px 30px;
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1000;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-content {
    margin-top: 50px;
}
    background-color: #f4f4f4;
}

header {
    position: relative;
    text-align: center;
    color: white;
}

.header-content {
    margin-top: 50px;
}

.header-img {
    width: 100%;
    height: 300px;
    object-fit: cover;
    filter: brightness(0.5);
}

 .slider {
            overflow: hidden;
            position: relative;
        }

        .slider-container {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 500%;
        }
.slide img {
    width: 100%;
    height: 70%;
    object-fit: cover;
}
.slide {
    width: 100%;
}
.logo {
    width: 50px;
    display: block;
    margin-top: 10px;
}

.about-company {
    padding: 20px;
    text-align: center;
    background-color: white;
    margin: 20px;
}

footer {
    background-color: #000;
    padding-top: 2.6rem;
    padding-bottom: 2.6rem;
    font-size: large;
    color: #757575;
    text-align: center;
    height: 100px;
}

.contact-form {
    background-color: white;
    padding: 20px;
    margin: 20px;
    border-radius: 10px;
}

.contact-form form {
    display: flex;
    flex-direction: column;
}

.contact-form label {
    margin-top: 10px;
}

.contact-form input, .contact-form textarea {
    padding: 10px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

.contact-form button {
    margin-top: 10px;
    padding: 10px;
    background-color: #333;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.contact-form button:hover {
    background-color: #555;
}

{# back css#}

        .body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        .chatbot-container {
            {#position: fixed;#}
            {#bottom: 30px;#}
            {#right: 30px;#}
            {#z-index: 1000;#}
             display: flex;
    align-items: center;
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1000;
    padding: 10px;
    border-radius: 30px;
        }
        .chatbot-button {
            background: #007bff;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: background 0.3s ease;
        }
        .chatbot-button:hover {
            background: #0056b3;
        }
        .chatbot-window {
            display: none;
            background: white;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            width: 350px;
            max-width: 100%;
            position: relative;
            overflow: hidden;
            max-height: 550px;
        }
        .chatbot-header {
            background: #007bff;
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .chatbot-header img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }
        .chatbot-header .close-button {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            outline: none;
        }
        .chatbot-body {
            max-height: 400px;
            {#max-height: calc(100% - 100px);#}
            overflow-y: auto;
            padding: 15px;
            background: #f9f9f9;
        }
        .chatbot-footer {
            padding: 10px 15px;
            border-top: 1px solid #ddd;
            background: #f1f1f1;
        }
        .msg_cotainer, .msg_cotainer_send {
            background: #e1e1e1;
            border-radius: 20px;
            padding: 10px 15px;
            margin: 10px 0;
            max-width: 75%;
            word-wrap: break-word;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        .msg_cotainer_send {
            background: #007bff;
            color: white;
            align-self: flex-end;
        }
        .msg_time, .msg_time_send {
            font-size: 10px;
            margin-top: 5px;
            color: gray;
        }
        .input-group .form-control {
            border-radius: 20px;
            border: 1px solid #ddd;
            padding: 10px 15px;
        }
        .input-group .send_btn {
            border-radius: 20px;
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .input-group .send_btn:hover {
            background: #0056b3;
        }
        .input-group-append {
            margin-left: 10px;
        }

        #suggestions {
            position: absolute;
            width: calc(100% - 32px); /* Adjust based on the input field width */
            max-height: 150px;
            overflow-y: auto;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .suggestion-item {
            padding: 8px 16px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .suggestion-item:hover {
            background-color: #f0f0f0;
        }


        {##}
        /* Styles for the suggestion container */
.suggestions-container {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 5px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}


.chatbot-icon {
  {#width: 50px;#}
  {#height: 50px; #}
  {#background-position: center; #}
  {#border-radius: 50%;#}
  {#  cursor: pointer; #}
     width: 70px;
  height: 70px;
  border-radius: 80%;
  object-fit: cover;
}

.chatbot-text {
    font-size: 15px;
    font-weight: bold;
    color: #333;
    margin-right: 1px;
    background: #007bff;
    color: white;
    padding: 15px 5px;
    border-radius: 20px;
}
.chatbot-subtext{
    font-size: 12px;
    color: white;
    padding-left: 30px;
}
.tata-logo {
     background-color: transparent;
    height: 60px;
    width: 60px;
    padding-left: 0px;
    letter-spacing: 100px;
    align-items: center;
}

    </style>

</head>
<body>
    <div class="background">

        <header>
            <nav>
                <div class="logo"><img src="{{ url_for('static', filename='images/logo_white.png') }}" alt="logo Image"></div>
                <img src="{{ url_for('static', filename='images/tata-logo.png') }}" class="tata-logo" alt="logo Image">
            </nav>
        </header>

    <section id="home" class="slider">
        <div class="slider-container">
            <div class="slide"> <img src="{{ url_for('static', filename='images/slider1.png') }}" alt="Slider1 Image"></div>
            <div class="slide"> <img src="{{ url_for('static', filename='images/slider2.png') }}" alt="Slider2 Image"></div>
            <div class="slide"> <img src="{{ url_for('static', filename='images/slider3.png') }}" alt="Slider3 Image"></div>
            <div class="slide"> <img src="{{ url_for('static', filename='images/slider4.png') }}" alt="Slider3 Image"></div>
            <div class="slide"> <img src="{{ url_for('static', filename='images/slider5.png') }}" alt="Slider3 Image"></div>

        </div>
    </section>

    <section id="about" class="about-company">
        <h2>About Tata Realty and Infrastructure Ltd</h2>
        <p>A 100 percent subsidiary of Tata Sons Pvt Ltd, founded by the great visionary Jamsetji Nusserwanji, was established in 2007. Tata Realty and Infrastructure Limited continues to build on this strong foundation and legacy of TATA. The Company is in the business of developing commercial real estate.</p>
        <p>Intellion is the exclusive office spaces vertical of Tata Realty and Infrastructure Ltd.</p>
    </section>

    <footer id="contact">
        <p>Â© 2024 Tata Realty and Infrastructure Limited. All rights reserved.</p>
    </footer>



    </div>

    <div class="chatbot-container">
         <div class="chatbot-text">ASK TATA REALTY<br>
         <span class="chatbot-subtext">LIVE CHAT</span></div>
        <button class="chatbot-button">
                 <img src="{{ url_for('static', filename='images/robo.jpg') }}" alt="logo Image" class="chatbot-icon">
        </button>

        <div class="chatbot-window">
            <div class="chatbot-header">
                <div>
                    <img src="{{ url_for('static', filename='images/botimage.png') }}" class="tata-logo" alt="logo Image">
                    <span style="font-size: large;padding-left: 20px; font-weight: bold">Property Pal</span>
                </div>
                <button class="close-button">&times;</button>
            </div>
            <div id="messageFormeight" class="chatbot-body"></div>
            <div class="chatbot-footer">
                <form id="messageArea" class="input-group">
                    <input type="text" id="text" name="msg" placeholder="Type your message..." autocomplete="off" class="form-control type_msg" required/>
                    <div class="input-group-append">
                        <button type="submit" id="send" class="input-group-text send_btn"><i class="fas fa-location-arrow"></i></button>
                    </div>
                </form>
                 <!-- Auto-suggestions -->
             <div id="suggestions" class="suggestions-container"></div>
            </div>
            <div class="chatbot-body">
                <div id="messageFormeight"></div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            let currentIndex = 0;
            const myslides = $('.slider-container .slide');
            const slideCount = myslides.length;
            const slideWidth = myslides.width();

            function showNextSlide() {
                currentIndex = (currentIndex + 1) % slideCount;
                $('.slider-container').css('transform', 'translateX(' + (-currentIndex * slideWidth) + 'px)');
            }

            setInterval(showNextSlide, 3000);

            $(".chatbot-button").on("click", function() {
                $(".chatbot-window").toggle();
                const isChatWindowVisible = $(".chatbot-window").is(":visible");
                if (isChatWindowVisible) {
                    $(".chatbot-button").hide();
                    $(".chatbot-text").hide();
                    displayWelcomeMessage();
                }
            });

            $(".close-button").on("click", function() {
                $(".chatbot-window").hide();
                $(".chatbot-button").show();
                $(".chatbot-text").show();
                $("#messageFormeight").empty();

            });

            $("#messageArea").on("submit", function(event) {
                event.preventDefault();
                const date = new Date();
                const hour = date.getHours();
                const minute = date.getMinutes();
                const str_time = hour + ":" + (minute < 10 ? '0' : '') + minute;
                const rawText = $("#text").val();

                const userHtml = `<div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">${rawText}<span class="msg_time_send">${str_time}</span></div>
                                  </div>`;

                $("#text").val("");
                $("#messageFormeight").append(userHtml);

                $.ajax({
                    data: { msg: rawText },
                    type: "POST",
                    url: "/get"
                }).done(function(data) {
                    const botHtml = `<div class="d-flex justify-content-start mb-4">
                                        <div class="msg_cotainer">${data.response}<span class="msg_time">${str_time}</span></div>
                                     </div>`;
                    $("#messageFormeight").append($.parseHTML(botHtml));
                    $("#messageFormeight").scrollTop($("#messageFormeight")[0].scrollHeight);
                });
            });

            function displayWelcomeMessage() {
                const date = new Date();
                const hour = date.getHours();
                const minute = date.getMinutes();
                const str_time = hour + ":" + (minute < 10 ? '0' : '') + minute;
                const welcomeMessage = "Hello! ð I am Property Pal, TATA REALTY Responsive and Intelligent Assistant.";

                const botHtml = `<div class="d-flex justify-content-start mb-4">
                                    <div class="msg_cotainer">${welcomeMessage}<span class="msg_time">${str_time}</span></div>
                                 </div>`;

                $("#messageFormeight").append(botHtml);
            }
        });

        $("#text").on("input", function() {
                const userInput = $(this).val().toLowerCase();
                const suggestions = getSuggestions(userInput);

                displaySuggestions(suggestions);
            });




        {##}

         // Extract keywords from qa_pairs
    const qa_pairs_keywords = Object.keys(qa_pairs).map(question => question.toLowerCase().split(" ")).flat();

    function displaySuggestions(suggestions) {
        const suggestionHTML = suggestions.map(suggestion => `<div class="suggestion-item">${suggestion}</div>`).join('');
        $("#suggestions").html(suggestionHTML);
    }

    $("#text").on("input", function() {
        const userInput = $(this).val().toLowerCase();
        const suggestions = [];

        qa_pairs_keywords.forEach(keyword => {
            if (userInput.includes(keyword)) {
                Object.keys(qa_pairs).forEach(question => {
                    if (question.toLowerCase().includes(keyword) && !suggestions.includes(question)) {
                        suggestions.push(question);
                    }
                });
            }
        });

        displaySuggestions(suggestions);
    });

    $(document).on('click', '.suggestion-item', function() {
        const suggestionText = $(this).text();
        $("#text").val(suggestionText);
        $("#suggestions").html('');
    });

    $(document).on('click', '.suggestion-item', function() {
    const suggestionText = $(this).text();
    $("#text").val(suggestionText);
    $("#suggestions").html('');
    $("#messageArea").submit(); // Automatically submit the form on suggestion click
});


    function displaySuggestions(suggestions) {
        const suggestionHTML = suggestions.map(suggestion => `<div class="suggestion-item">${suggestion}</div>`).join('');
        $("#suggestions").html(suggestionHTML);
    }

    // Event handler for input change
    $("#text").on("input", function() {
        const userInput = $(this).val().toLowerCase();
        const suggestions = [];

        qa_pairs_keywords.forEach(keyword => {
            if (userInput.includes(keyword)) {
                Object.keys(qa_pairs).forEach(question => {
                    if (question.toLowerCase().includes(keyword) && !suggestions.includes(question)) {
                        suggestions.push(question);
                    }
                });
            }
        });

        displaySuggestions(suggestions);
    });

    // Event handler for suggestion click
    $(document).on('click', '.suggestion-item', function() {
        const suggestionText = $(this).text();
        $("#text").val(suggestionText);
        $("#suggestions").html('');
    });

        {##}
    </script>
</body>
</html>
